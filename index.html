<!DOCTYPE html>

<html>

<head>
    <title> three.js Control GUI_95  </title>
<script src="https://www.gstatic.com/firebasejs/5.9.1/firebase.js"></script>
    <script type="text/javascript" src="./libs/three.js"></script>
    <script type="text/javascript" src="./libs/stats.js"></script>
    <script type="text/javascript" src="./libs/dat.gui.js"></script>
    <script type="text/javascript" src="./libs/STLLoader.js"></script>
    <script type="text/javascript" src="./libs/OrbitControls.js"></script>
    <script type="text/javascript" src="./libs/helvetiker_regular.typeface.js"></script>
        <script src="https://preview.babylonjs.com/babylon.js"></script>
    <style>
        body {
            /* set margin to 0 and overflow to hidden, to go fullscreen */
            margin: 0;
            overflow: hidden;

        }
    </style>
</head>
<body>

<div id="Stats-output">
</div>
<!-- Div which will hold the Output -->
<div id="WebGL-output">
</div>
<!-- Javascript code that runs our Three.js examples -->
<img src="https://firebasestorage.googleapis.com/v0/b/fisto-a251b.appspot.com/o/trojit%C3%A9%20v%C3%A9.bmp?alt=media&token=8e3bf320-10c7-4496-b723-ac7315af9a0e" width="20" height="20"  />

<a style="background-color:yellow;">________________________________________________________________________________________________________________</a>

<script type="module">
  import {sayHi} from "./sayHi.js";
  console.log(" import = ",sayHi(" import textik ")); 
</script>

<script type="text/javascript">
var engine = new BABYLON.NullEngine();
var scene = new BABYLON.Scene(engine);
	
//..................................  Initialize Firebase  

  var config = {
    apiKey: "AIzaSyDQKtJDqES4Xu4OsFWNdeglaGdbJkfFdT4",
    authDomain: "fisto-a251b.firebaseapp.com",
    databaseURL: "https://fisto-a251b.firebaseio.com",
    projectId: "fisto-a251b",
    storageBucket: "fisto-a251b.appspot.com",
    messagingSenderId: "372346394450"
  };
  firebase.initializeApp(config);

var db = firebase.firestore();
//..................................  Initialize Firebase  	
//ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss
// prizpusobeni okraje sceny	
    window.addEventListener('resize', onResize, false);

	function onResize() {
  camera.aspect = window.innerWidth / window.innerHeight;
  camera.updateProjectionMatrix();

  renderer.setSize(window.innerWidth, window.innerHeight);
}
var camera;

var scene;
var renderer;
//ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss
    // once everything is loaded, we run our Three.js stuff.
    function init() {
/* nechat
//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++	    
	             var loader = new THREE.STLLoader(); //loader
            loader.load( 'freza.stl', function ( geometry ) {
                var material = new THREE.MeshPhongMaterial( { color: 'skyblue' } );
                var mesh = new THREE.Mesh( geometry, material );
//                console.log("mesh = ", mesh);
		                    mesh.scale.x = 0.2;
		    		    mesh.scale.y = 0.2;
		    		    mesh.scale.z = 0.2;
//nechat				    
*/
    
	    

        scene = new THREE.Scene();

//YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY
var msg = document.createElement('div');
msg.style.position = 'absolute';
//text2.style.zIndex = 1;    // if you still don't see the label, try uncommenting this
msg.style.width = 100;
msg.style.height = 100;
msg.style.backgroundColor =  "rgba(155,155,155,0.95)";                    //"rgba(255,0,255,0.95)";  //"blue";
msg.innerHTML = "";
msg.style.top = 80 + 'px';
msg.style.left = 20 + 'px';
document.body.appendChild(msg);
//YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY


var geometry = new THREE.BoxGeometry( 0.01, 0.01, 0.01 );
var material = new THREE.MeshBasicMaterial( {color: 0xffff00} );
var cube = new THREE.Mesh( geometry, material );
//TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT
       var text1;
var options = {
  size: 90,
  height: 90,
  weight: 'normal',
  font: 'helvetiker',
  style: 'normal',
  bevelThickness: 2,
  bevelSize: 4,
  bevelSegments: 3,
  bevelEnabled: true,
  curveSegments: 12,
  steps: 1
};

        function createMesh(geom) {

            var meshMaterial = new THREE.MeshLambertMaterial({color: 0x99ffff});
		meshMaterial.wireframe = false;
            var plane = THREE.SceneUtils.createMultiMaterialObject(geom, [meshMaterial]);

            return plane;
        }
	
	
text1 = createMesh(new THREE.TextGeometry("V", options));
text2 = createMesh(new THREE.TextGeometry("V", options));
text3 = createMesh(new THREE.TextGeometry("V", options));

//TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT	
    
		    
//nechat scene.add( mesh );
	    
		    
				renderer = new THREE.WebGLRenderer( { antialias: true } );
				renderer.setClearColor( 0xcccccc, 0.0 );
				renderer.setSize( window.innerWidth*0.97, window.innerHeight*0.97 );
				document.body.appendChild( renderer.domElement );

                                camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);
				camera.position.set( - 50, 0, 50 );


//CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC		    
				controls = new THREE.OrbitControls( camera, renderer.domElement );
// pri vyrazeni useku CCCCCCCCCCCC nema mys vliv na scenu
//				controls.minDistance = 10;  // tohle jenom presouva
//				controls.maxDistance = 500; //     -//-
camera.position.set( 0, 20, 100 );
controls.update();
//CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC		    
		    
        camera.position.x = -30;
        camera.position.y = 40;
        camera.position.z = 30;
        camera.lookAt(scene.position);

        var ambientLight = new THREE.AmbientLight(0x0c0c0c);
        scene.add(ambientLight);

        var spotLight = new THREE.SpotLight(0xffffff);
        spotLight.position.set(-40, 60, -10);
        spotLight.castShadow = true;
        scene.add(spotLight);

        document.getElementById("WebGL-output").appendChild(renderer.domElement);

        var step = 0;


        var params = new function () {
            this.input_com_text = "4,4??";
            this.input_dataIO_text = "vstupní nebo výstupní text";
        };
        
        
    var gui = new dat.GUI();
    var item1 = gui.add(params, "input_com_text").onFinishChange(function (ivalue) { });  // i-o value obsahuje input pole  a neni snad ani potreba
    var item2 = gui.add(params, "input_dataIO_text").onFinishChange(function (ovalue) { });
	    
    var un = 0; // gui chodi dvakrat (snad kazdy event) a tak z nouze omezeni conzole
	    render();
var jj = 0;
var polerad;
    polerad = [];
var polevar = "";
var polecyk = "";
var promP = "";
var promL = "";
var hodn = 0;
var jt = 0;
var vystupscript = "hello Three Js";
var ja = 0;
var longu = "";

		text1.scale.x = 0.04;
		text1.scale.y = 0.04;
		text1.scale.z = 0.01;


		text2.scale.x = 0.04;
		text2.scale.y = 0.04;
		text2.scale.z = 0.01;

		text3.scale.x = 0.04;
		text3.scale.y = 0.04;
		text3.scale.z = 0.01;



                   cube.position.x = -5.7; 
                   cube.position.y =  2; 
                   cube.position.z = 0.5; 

 var korex = 5.75;
 var korey = -2.2 ;
 var korez = -0.45;

text1.position.x = korex + 0;
text2.position.x = korex + 10.0;
text3.position.x = korex + (-10.0);

text1.position.y = korey ;
text2.position.y = korey ;
text3.position.y = korey ;

text1.position.z = korez ;
text2.position.z = korez ;
text3.position.z = korez ;



scene.add( text1 );
scene.add( text2 );
scene.add( text3 );

scene.add( cube );







                   text1.parent = cube;
                   text2.parent = cube;
                   text3.parent = cube;


//RRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRR
//  || &&  Math.abs  prik.substring(prik.indexOf ("=")+1,prik.length-2)  Number(r)  +"\n"+	    
        function render() {
//WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW
     if   ( (params.input_com_text.indexOf ("§§§"))>=0 ) 
     { // beg §§§ z input_dataIO.text

//++++++++++++++++++++++++++++++++ script ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
//++++++++++++++++++++++++++++++++ script ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


     jj = 0;
     poc = vystupscript ;



    if (jj == 0)
     { // beg pouze nulty   

//(((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((
var stred = "";
i = 0;
j = 0;
while (i <= poc.length) // vynechani neviditelnych znaku 
{ // while nastradani hodnot znaku , s vynechanim kodu 10 a 9 ,aby se dalo zadavat z editu
  znak = poc.substr(i,1);
       if ((znak.charCodeAt(znak) == 10)||(znak.charCodeAt(znak) == 9))  //   Carriage return = 13  ; Line feed = 10 ; Horizontal Tab = 9
       {
//       console.log(" i  = ",i,"   znak = ", znak.charCodeAt(znak));
       }
        else
       {//else beg
       stred = stred + znak ;
       }//else end

  i = i + 1; 

}    // endwhile nastradani hodnot znaku
poc = stred;


var priknul = "";
var povel = "";
var priknultext = "";
var poveltext = "";
var program = "";
var programtext = "";
i = 0;
j = 0;
while (i <= poc.length)
{ // while -rozbetlovani po radkach do "polerad" a vynechani mezer
  priknul = poc.substr(i,1);
  priknultext = poc.substr(i,1);

       if (priknul.charCodeAt(priknul) == 13)
       {  //if pro zamenu konce radku s kodem 13 za znak § s kodem 167
       priknul = "§";
       priknultext = "§" + "  " + "\n";
       }  // endif

  if (priknul.charCodeAt(priknul) != 39)
  {    // if pokud neni apostrof
       //mrzeru vynecha a tak nic pozdeji neovlivni 
       if (priknul.charCodeAt(priknul) != 32)
       {
       povel = povel + priknul;
       poveltext = poveltext + priknultext;
       }
  }    // endif pokud neni apostrof
  else
  {    // else pokud je apostrof
        povel = povel + priknul;
        poveltext = poveltext + priknultext;
        i=i+1;  
        priknul = poc.substr(i,1);
        priknultext = poc.substr(i,1);
        while (priknul.charCodeAt(priknul) != 39)
        { // while zachova mezery v apostrofrech
        priknul = poc.substr(i,1);
        priknultext = poc.substr(i,1);
        povel = povel + priknul;
        poveltext = poveltext + priknultext;
        i=i+1;
        } // endwhile zachova mezery v apostrofrech

           if    (priknul.charCodeAt(priknul) == 39)           
           { // if  while nprida posledni znak (i=i+1) tak se musi tady
           priknul = poc.substr(i,1);
           priknultext = poc.substr(i,1);
           povel = povel + priknul;
           poveltext = poveltext + priknultext;
           } // endif while nprida posledni znak (i=i+1) tak se musi tady

  }     // endelse pokud je apostrof


  if (priknul.charCodeAt(priknul) == 167)   //13
  {
  j = j + 1;   //je li konec radku
  polerad[j] = povel;

      if  ((povel.indexOf("$"))>=0)
      { // if do polevar pridat bez $ a v aktual nepustit do deklarace s $

        polevartest = polevar;
        promtest = povel.substr(povel.indexOf ("$")+1,povel.indexOf ("="));


        if  ((polevartest.indexOf(promtest))>=0)
        { // beg existence s dolarem ,$ oznacuje globalni promenne - je zahodno pouzit na promenne pro jednoznacnost stejny pocet znaku
        } // end existence s dolarem
        else
        { // beg else existence s dolarem
        polevar = polevar + povel.substr(povel.indexOf ("$")+1,povel.indexOf (";"));
        } // end else existence s dolarem


      } // endif do polevar pridat bez $ a v aktual nepustit do deklarace s $

  program = program + povel;
  programtext = programtext + String(j) + " " + poveltext;  

  povel = "";  //vynulování radkoveho textu
  poveltext = "";
  } //endif pro konec radku == 167 -> § 
  i = i + 1;   //pro kazdy znak
} // endwhile -rozbetlovani po radkach do "polerad" a vynechani mezer





var ubercykl = "";
    ubercykl = program;
i=0;
//j ma hodnotu poctu radku z minula
polecyk = "";
var k = 0;
var r = 0;
var pracuj = "";
var sumzav = 0;
while (i < j)  
{ // while vytvori polecyk ve formatu "zavo19=cykl2;" koncova zavorka } ma index v polerad[i] i=19 a patri k cyklu v polerad[i] i=2
  // rozdil indexu 19-2 = 17 udava pocet prikazu v tomto cyklu 
  i = ++i;
  priknul = polerad[i];


      if ((priknul.indexOf("cykl"))>=0)     
      { // if na pritomnost "cykl"
      k = i; // index vyskytu "cykl" v polerad[i]
      r = 0;
      pracuj = "ano";
      sumzav = 0; //soucet zavorek
           while (pracuj == "ano")  
           { // while - pocita obe zavorky
           i = i+1;
           r = r+1; //pocet radku v cyklu
           priknul = polerad[i];

              if ((priknul.indexOf("{"))>=0)     
              {
              sumzav = sumzav + 1;
              }
              if ((priknul.indexOf("}"))>=0)     
              {
              sumzav = sumzav - 1;
              } 
              if (sumzav == 0)     
              { 
              pracuj = "ne";
              i = k+1;   
              polecyk = polecyk + "zavo" + (Number(k)+Number(r)) + "=" + "cykl" + k + ";";
              } 

           } // endwhile - pocita obe zavorky
          
      }  // endif na pritomnost "cykl"

}  //endwhile vytvori polecyk     

//((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((
      
      } // end pouze nulty



//°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°


i=0;
while (i < j)  
{ //while (i < j) pracovni cyklus 
//  i = ++i;
  i += 1;
var prik = String(polerad[i]);
// vyraz a prirazeni    vyraz a prirazeni      vyraz a prirazeni     vyraz a prirazeni     vyraz a prirazeni 

      if  (((prik.indexOf("="))>=0)&&(prik.indexOf("(")==-1) &&(prik.indexOf("-")==-1)  &&(prik.indexOf("+")==-1) &&(prik.indexOf("#")==-1) &&(prik.indexOf("*")==-1) &&(prik.indexOf("/")==-1) &&(prik.indexOf("~")==-1) &&(prik.indexOf("^")==-1) &&(prik.indexOf("&")==-1)      )
      {   // if pro prirazeni hodnoty bez znamenka
      aktual (prik);
      } //if pro prirazeni hodnoty bez znamenka
      else
      { // else pro prirazeni hodnoty se zapornym znamenkem a vyraz

        if  ( (prik.indexOf("=")+1)==(prik.indexOf("-")) )  
        {  // if pro prirazeni hodnoty se zapornym znamenkem  
        aktual (prik); 
        }  // endif pro prirazeni hodnoty se zapornym znamenkem  

        if  ( (  ((prik.indexOf("=")+1)!=(prik.indexOf("-"))) && ( (prik.indexOf("-")!=-1)  ||   (prik.indexOf("+")!=-1) || (prik.indexOf("#")!=-1)|| (prik.indexOf("*")!=-1)|| (prik.indexOf("/")!=-1)|| (prik.indexOf("~")!=-1) || (prik.indexOf("^")!=-1) || (prik.indexOf("&")!=-1)       )    )    && (prik.indexOf("vert")==-1) &&(prik.indexOf("addPolygon")==-1) &&(prik.indexOf("closeLine")==-1)      )
        {    // if pro vlastni vyraz , ale ne vert


                        hola = prik.substring(0,prik.indexOf ("="));
                        levastr =   polevar.substr(0,polevar.indexOf (hola));
                        pravastr =  polevar.substr(polevar.indexOf (hola),polevar.length)  ;
                        pravastr =  pravastr.substr(pravastr.indexOf (";")+1,pravastr.length)  ;

                        promL = prik.substring(prik.indexOf ("=")+1,prik.length-2);
                        promLpuv = promL; //protoze za chvili bude orezana o operator
                           if   ( (promL.indexOf ("+"))>=0 )
                           {  // 
                           promL = promL.substring(0,promL.indexOf ("+"));
                           promP = prik.substring(prik.indexOf ("+")+1,prik.length-2);
                           }  // 
                           if   ( (promL.indexOf ("-"))>=0 )
                           {  // 
                           promL = promL.substring(0,promL.indexOf ("-"));
                           promP = prik.substring(prik.indexOf ("-")+1,prik.length-2);
                           }  // 
                           if   ( (promL.indexOf ("#"))>=0 )
                           {  // mocnina odmocnina
                           promL = promL.substring(0,promL.indexOf ("#"));
                           promP = prik.substring(prik.indexOf ("#")+1,prik.length-2);
                           }  // 
                           if   ( (promL.indexOf ("*"))>=0 )
                           {  // 
                           promL = promL.substring(0,promL.indexOf ("*"));
                           promP = prik.substring(prik.indexOf ("*")+1,prik.length-2);
                           }  // 
                           if   ( (promL.indexOf ("/"))>=0 )
                           {  // 
                           promL = promL.substring(0,promL.indexOf ("/"));
                           promP = prik.substring(prik.indexOf ("/")+1,prik.length-2);
                           }  // 
                           if   ( (promL.indexOf ("~"))>=0 )
                           {  // SIN
                           promL = promL.substring(0,promL.indexOf ("~"));
                           promP = prik.substring(prik.indexOf ("~")+1,prik.length-2);
                           }  // 
                           if   ( (promL.indexOf ("^"))>=0 )
                           {  // COS
                           promL = promL.substring(0,promL.indexOf ("^"));
                           promP = prik.substring(prik.indexOf ("^")+1,prik.length-2);
                           }  // 
                           if   ( (promL.indexOf ("&"))>=0 )
                           {  // TAN
                           promL = promL.substring(0,promL.indexOf ("&"));
                           promP = prik.substring(prik.indexOf ("&")+1,prik.length-2);
                           }  // 


                           promLhod =  polevar.substr(polevar.indexOf (promL),polevar.length)  ;
                           promLhod =  promLhod.substr(0,promLhod.indexOf (";"))  ;
                           promLhod =  promLhod.substr(promLhod.indexOf ("=")+1,polevar.length)  ;

                             if  ( (promLhod.indexOf ("'"))>=0 ) 
                             {   // if leva ve vyrazu je string
                             promLhod = promLhod.substr(0,promLhod.lastIndexOf ("'"))  ;
  
                                    if   ((polevar.indexOf(promP))>=0)
                                    {  // if prava je  promenna se stringem
                                        promP =  polevar.substr(polevar.indexOf (promP),polevar.length)  ;
                                        promP =  promP.substr(0,promP.indexOf (";"))  ;
                                        promP =  promP.substr(promP.indexOf ("=")+1,polevar.length)  ;
                                    }  // endif prava je  promenna se stringem

                             promP = promP.substr(1,promP.length)  ;
                             hodn = promLhod + promP;
                             }  // endif leva ve vyrazu je string
                             else   
                             {  // else jinak bud primo cisla nebo promenne
                                if  ( ( (polevar.indexOf (promP))>=0 )&& isNaN(Number(promP))     )
                                {  // nesmi bejt cislo a musi ji najit v polevar jako  uz nadeklarovanou promennou
                                promPhod =  polevar.substr(polevar.indexOf (promP),polevar.length)  ;
                                promPhod =  promPhod.substr(0,promPhod.indexOf (";"))  ;
                                promPhod =  promPhod.substr(promPhod.indexOf ("=")+1,polevar.length)  ;
                                }  // 
                                else
                                { // else je cislo
                                 promPhod = promP;
                                } // endelse je cislo

                                           if   ( (promLpuv.indexOf ("+"))>=0 )
                                           {  // 
                                           hodn = Number(promLhod) + Number(promPhod); 
                                           }  // 

                                           if   ( (promLpuv.indexOf ("-"))>=0 )
                                           {  // 
                                           hodn = Number(promLhod) - Number(promPhod); 
                                           }  // 
                                           if   ( (promLpuv.indexOf ("#"))>=0 )
                                           {  // mocnina odmocnina
                                           hodn =   Math.pow (  Number(promLhod), Number(promPhod)); 
                                           }  // 
                                           if   ( (promLpuv.indexOf ("*"))>=0 )
                                           {  // 
                                           hodn =     Number(promLhod) * Number(promPhod); 
                                           }  // 
                                           if   ( (promLpuv.indexOf ("/"))>=0 )
                                           {  // 
                                           hodn =     Number(promLhod) / Number(promPhod); 
                                           }  // 
                                           if   ( (promLpuv.indexOf ("~"))>=0 )
                                           {  // SIN
                                           hodn =     Math.sin(Number(promPhod)*(Math.PI/180)); 
                                           }  // 
                                           if   ( (promLpuv.indexOf ("^"))>=0 )
                                           {  // COS
                                           hodn =     Math.cos(Number(promPhod)*(Math.PI/180)); 
                                           }  // 
                                           if   ( (promLpuv.indexOf ("&"))>=0 )
                                           {  // TAN
                                           hodn =     Math.tan(Number(promPhod)*(Math.PI/180)); 
                                           }  // 

                             } // endelse jinak bud primo cisla nebo promenne


                             polevar = levastr + hola + "=" + hodn + ";" + pravastr;

        }    // endif pro vlastni vyraz  , ale ne vert

      }  // konec else pro prirazeni hodnoty se zapornym znamenkem a vyraz
// vyraz a prirazeni    vyraz a prirazeni      vyraz a prirazeni     vyraz a prirazeni     vyraz a prirazeni 


//zavorkyzavorkyzavorkyzavorkyzavorkyzavorkyzavorkyzavorkyzavorkyzavorkyzavorkyzavorkyzavorkyzavorky


        if   ((prik.indexOf("{"))>=0)   // jestli ma preskocit  ,(i-1)prikaz cyklu ne pocatecni zavorky
        {  // if pro pocatecni zavorku
         plati(polerad[i-1]);
              if   (splneno == "ne")   
              {  // if pro preskok
              preskok = polecyk.substring(0,polecyk.indexOf ("cykl"+(i-1)));
              preskok = preskok.substring(preskok.lastIndexOf("zavo")+4,preskok.length-1);
              preskok = (Number(preskok)-(i-0));  // (i-0)  drive (i-1)
              i = i + Number(preskok);
              var prik = polerad[i];
              }  // endif pro preskok
        }  // endif pro pocatecni zavorku


        if   ((prik.indexOf("}"))>=0)   // jestli se ma vratit
        {  // if pro vraceci zavorku
        vraceni = polecyk.substring(polecyk.indexOf ("zavo"+i)+4,polecyk.length);
        vraceni = vraceni.substring(0,vraceni.indexOf (";"));
        vraceniL = vraceni.substring(0,vraceni.indexOf ("="));
        vraceniP = vraceni.substring(vraceni.indexOf ("cykl")+4,vraceni.length);
        vraceni = Number(vraceniL)-Number(vraceniP)
        plati(polerad[i-vraceni]);

                    rovcyk = polerad[i-vraceni];
                    if   ((rovcyk.indexOf("="))>=0)   // je v cyklu "="
                    {  // if pro nesplneni a tim pokracovani
                    splneno =  "ne";
                    }  // endif pro nesplneni a tim pokracovani

              if   (splneno == "ano")   // jestli se ma vratit
              {  // if pro preskok
              i = i - vraceni+1 ;
              }  // endif pro preskok
           
        }  // endif pro vraceci zavorku

//zavorkyzavorkyzavorkyzavorkyzavorkyzavorkyzavorkyzavorkyzavorkyzavorkyzavorkyzavorkyzavorkyzavorky

//dispdispdispdispdispdispdispdispdispdispdispdispdispdispdispdispdispdispdispdispdispdispdispdisp
        if   ((prik.indexOf("disp"))>=0)   // ma vypsat vybrané promenne
        {  // if pro vypis
         //   promenne v zavorkach do disprik       format -> disp (vc1,vc6,vc2);     
         disprik = prik.substring(prik.indexOf ("(")+1,prik.indexOf (")") ) + ",";

            disbude = "";
            while (disprik.length > 0 )  
            { //while pro disp()
            disprom = disprik.substring(0,disprik.indexOf (","));

            if  (  ((polevar.indexOf(disprom))>=0) && isNaN(Number(disprom))   )
                 {  // if je li ve disp promenna

                    // z polevar si vyseparuje hodnotu k vypisu
                    promdis =  polevar.substr(polevar.indexOf (disprom),polevar.length)  ;
                    promdis =  promdis.substr(0,promdis.indexOf (";"))  ;
                    promdis =  promdis.substr(promdis.indexOf ("=")+1,polevar.length)  ;

            
                    if   ((promdis.indexOf("'"))>=0)   // je apostrof
                    {  // if pro odebrani apostrofu
                    promdis =  promdis.substr(1,promdis.lastIndexOf ("'")-1)  ;
                    }  // endif pro odebrani apostrofu


                 }  // endif je li ve disp promenna
                 else 
                 {  // else je li text
                 promdis = disprom; 
                 }  // endelse je li text

              disbude =  disbude + promdis + " " ; 
            // ubere promennou zleva po carku ","
            disprik = disprik.substring(disprik.indexOf (",")+1,disprik.length ); 
            } //endwhile pro disp()


//YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY
msg.innerHTML = disbude;
//YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY

        }  // endif pro vypis

//dispdispdispdispdispdispdispdispdispdispdispdispdispdispdispdispdispdispdispdispdispdispdispdisp


} //endwhile (i < j) pracovni cyklus 
//°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°
//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAApodfunkce

function plati (podminka)
   {  // funkce plati
      prik = podminka; 
// pro cykl pro cykl pro cykl pro cykl pro cykl pro cykl pro cykl pro cykl
      if ((prik.indexOf("cykl"))>=0)     
      {  // if cykl
      lvar = prik.substring(prik.indexOf ("(")+1,prik.indexOf (")") ); // kuli mezeram vepredu

//typy operatoru podminky++++++    
           if (  ((prik.indexOf("="))>=0) && ((prik.indexOf("!="))== -1)  )
           {
           lvar = lvar.substring(0,lvar.indexOf ("=") ); 
           pvar=prik.substring(prik.lastIndexOf ("=")+1,prik.indexOf (")") );
           strpodm = "rovno"; 
           }
           if ((prik.indexOf("!="))>=0) 
           {
           lvar = lvar.substring(0,lvar.indexOf ("!=") ); 
           pvar=prik.substring(prik.lastIndexOf ("!=")+2,prik.indexOf (")") ); 
           strpodm = "ruzne"; 
           }
           if ((prik.indexOf("<"))>=0) 
           {
           lvar = lvar.substring(0,lvar.indexOf ("<") ); 
           pvar=prik.substring(prik.lastIndexOf ("<")+1,prik.indexOf (")") ); 
           strpodm = "mensi"; 
           }
           if ((prik.indexOf(">"))>=0) 
           {
           lvar = lvar.substring(0,lvar.indexOf (">") ); 
           pvar=prik.substring(prik.lastIndexOf (">")+1,prik.indexOf (")") ); 
           strpodm = "vetsi"; 
           }
//typy operatoru podminky++++++    

      lvar = polevar.substring(polevar.indexOf (lvar),polevar.length );
      lvar = lvar.substring(0,lvar.indexOf (";") );
      lvar = lvar.substring(lvar.lastIndexOf ("=")+1,lvar.length);


                                if  ( ( (polevar.indexOf (pvar))>=0 )&& isNaN(Number(pvar)  ) )
                                {  // if nesmi bejt cislo a musi ji najit v polevar jako  uz nadeklarovanou promennou
                                pvar =  polevar.substr(polevar.indexOf (pvar),polevar.length)  ;
                                pvar =  pvar.substr(pvar.indexOf ("=")+1,pvar.length)  ; // bez konce to taky chodi
                                pvar =  pvar.substr(0,pvar.indexOf (";"))  ;
                                }  // endif nesmi bejt cislo a ...



      podm(Number(lvar),Number(pvar));


           splneno = "ne";
           if (strpodm == strporov) 
           {
           splneno = "ano";
           }
           if (((strpodm == "ruzne")&&(strporov == "vetsi"))||((strpodm == "ruzne")&&(strporov == "mensi")))
           {
           splneno = "ano";
           }
// pro cykl pro cykl pro cykl pro cykl pro cykl pro cykl pro cykl pro cykl
      } // endif cykl

   } // end funkce plati



function podm (parl,parp)
      {
           if (parl == parp) 
           {
           strporov = "rovno";
           }
           if (parl != parp) 
           {
           strporov = "ruzne";
           }
           if (parl > parp) 
           {
           strporov = "vetsi";
           }
           if (parl < parp) 
           {
           strporov = "mensi";
           }


      }

function aktual (prik)
      {  //funkce aktual

//text80 = polevar.length;
            if  (((prik.indexOf("="))>=0)&&(prik.indexOf("(")==-1)  &&(prik.indexOf("$")==-1)    )
            {  //aby nepripisoval do "polevar" prikaz cyklu
                   if  (((polevar.indexOf(   prik.substring(0,prik.indexOf ("="))  ))>=0)  )   
                    { //if pro nalezena a je provedena aktualizace
                        // najit zda prava strana je promenna   
                        promQ = (  prik.substring(prik.indexOf ("=")+1,prik.length-2) );
                        if  (   (((polevar.indexOf(   prik.substring(prik.indexOf ("=")+1,prik.length-2)  ))>=0)  ) &&  isNaN(Number(promQ))   &&  (promQ.lastIndexOf("'")==-1)      )
                        { //if pro nalezena a je vybrana jeji hodnota
                        hola = prik.substring(0,prik.indexOf ("="));
                        levastr =   polevar.substr(0,polevar.indexOf (hola));
                        pravastr =  polevar.substr(polevar.indexOf (hola),polevar.length)  ;
                        pravastr =  pravastr.substr(pravastr.indexOf (";")+1,pravastr.length)  ;
                        
                        prahola = prik.substring(prik.indexOf ("=")+1,prik.length-2);

                        hodn =   polevar.substr(polevar.indexOf (prahola),polevar.length);

                        hodn =   hodn.substring(hodn.indexOf ("=")+1,hodn.indexOf (";"));

                        polevar = levastr + hola + "=" + hodn +";"+ pravastr;

                        }  // konec pro prava strana je promenna
                        else
                        { // else pro prava strana je cislo
                        hola = prik.substring(0,prik.indexOf ("="));
                        levastr =   polevar.substr(0,polevar.indexOf (hola));
                        pravastr =  polevar.substr(polevar.indexOf (hola),polevar.length)  ;
                        pravastr =  pravastr.substr(pravastr.indexOf (";")+1,pravastr.length)  ;
                        hodn = prik.substring(prik.indexOf ("=")+1,prik.indexOf (";"))

                        polevar = levastr + hola +"="+ hodn +";"+ pravastr;
                        } // konec else pro prava strana je cislo 

                    } //konec if pro nalezena a je provedena aktualizace
                    else   
                    { //else pro  nenalezena

                    polevar = polevar + prik.substring(0,prik.indexOf (";")+1);
                    } //endelse pro  nenalezena
            } // endif aby nepripisoval do "polevar" prikaz cyklu
      } // end funkce aktual
//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAApodfunkce


//++++++++++++++++++++++++++++++++ script ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
//++++++++++++++++++++++++++++++++ script ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


     } // end §§§


      jj = jj + 1;





//..............................................nacteni..........................................................
			
				
//params.input_com_text je vstup
//input_dataIO_text je vystup
		   if   ( (params.input_com_text.indexOf ("???"))>=0 ) 
		   {  // ???
//                   console.log("Ajt = ",jt,"   idi = ",idi,"   koni = ",koni,"   params.input_com_text = ",params.input_com_text);
		   params.input_com_text = params.input_com_text.substring(0,(params.input_com_text.length-1)); // odebrani 

//___________________________________________aktualizace gui , vlozeno empirie -vzdy 2 pruchody____________________________
     gui.remove(item1);
     item1 = gui.add(params, "input_com_text").onFinishChange(function (ivalue) { });
//___________________________________________aktualizace gui , vlozeno empirie -vzdy 2 pruchody____________________________

                   jt = jt + 1;
		   if  (jt == 2)
		   {  // jt
           var vystup = "";
           vystupscript = "";

           var poci = params.input_com_text.substring(0,(params.input_com_text.indexOf (",")));
           var koni = params.input_com_text.substring(params.input_com_text.indexOf (",")+1,params.input_com_text.indexOf ("??"));
           var idi = Number(poci);



//                   console.log("Bjt = ",jt,"   idi = ",idi,"   koni = ",koni,"   params.input_com_text = ",params.input_com_text);
                   jt = 0;
                    
           vystupscript = "";
           while (idi <= Number(koni)) 
           {  //cykl
	           var docRef = db.collection("users").doc(String(idi));    //cteni z firestore
                   docRef.get().then(function(doc) {
                   if (doc.exists) {
		           vystup = vystup + "/"  + doc.data().name + "%" ; //pro ???!!!--- 
		           vystupscript = vystupscript + doc.data().name;   //pro script a na obrazovku


//######################################################## levy alt 35 ###################################################
var mriz = vystup;
var mrizcenc = "";
i = 0;
j = 0;
while (i <= mriz.length)
{ // while nahrazeni Enter mrizi
  znakmrize = mriz.substr(i,1);

       if (znakmrize.charCodeAt(znakmrize) == 13)
       {  //if pro zamenu konce radku s kodem 13 za znak # s kodem 35
       znakmrize = "#";
       }  // endif  pro zamenu konce radku s kodem 13 za znak # s kodem 35

      mrizcenc = mrizcenc + znakmrize;
      i = i + 1;

}  // endWhile  nahrazeni Enter mrizi
   vystup = mrizcenc;
//######################################################## levy alt 35 ###################################################

			   
//___________________________________________aktualizace gui_______________________________________________________________

			   
params.input_dataIO_text = vystup;
msg.innerHTML = " nacteno z Firestore " + vystupscript;
			   
gui.remove(item1);
gui.remove(item2);
			   
     item1 = gui.add(params, "input_com_text").onFinishChange(function (ivalue) { });
     item2 = gui.add(params, "input_dataIO_text").onFinishChange(function (ovalue) { });
			   
//__________________________________________aktualizace gui________________________________________________________________

                   } else {
                   console.log("No such document! nemáme dvakrát jsme se dívali zeptejte se po neděli");
		           vystup = vystup + "/" + "nic" + ";" + "\n" ; //vypis vlevo nahore plochy
                   }
                   }).catch(function(error) {
                   console.log("Error getting document:", error);
                   });                                               //cteni z firestore
              idi = idi + 1;
	   
	   }  //cykl
   	   } // jt
   	   } // ???
//..............................................nacteni..........................................................	
		
				
//----------------------------------------------pridani-----------------------------------------------
		    if   ( (params.input_com_text.indexOf ("!!!"))>=0 ) 
		   {
		   params.input_com_text = params.input_com_text.substring(0,(params.input_com_text.length-1));; // odebrani ;
           var poci = params.input_com_text.substring(0,(params.input_com_text.indexOf (",")));
           var koni = params.input_com_text.substring(params.input_com_text.indexOf (",")+1,params.input_com_text.indexOf ("!!"));
           var idi = Number(poci);
           var uberec = "";
           var sourec = params.input_dataIO_text;			   

//######################################################## levy alt 35 zpet na Enter (asci kod 13) ###################################################
//zere to znaky vepredu -> pred zapisem musi byt mezera za lomitkem pred prvnim znakem scriptu , 
//mezi apostrofy '   ' to nesnasi znaky  % * + - /  a mozna dalsi
var mriz = sourec;
var mrizcenc = "";
i = 0;
j = 0;
while (i <= mriz.length)
{ // while nahrazeni mrize Entrem
  znakmrize = mriz.substr(i,1);

       if (znakmrize.charCodeAt(znakmrize) == 35)
       {  //if pro zamenu znaku # s kodem 35 za Enter (asci kod 13)
       znakmrize = String.fromCharCode(13);
       }  // endif pro zamenu znaku # s kodem 35 za Enter (asci kod 13)

      mrizcenc = mrizcenc + znakmrize;
      i = i + 1;

}  // endWhile  nahrazeni Enter mrizi
   sourec = mrizcenc;

//      format pro zapis   (lomitko,mezera,script,procenta)   / $promb=60;#vara=111;#varb=222;#disp(promb,' = promb ');#cykl(promb<20)#{#promb=60;#}#promb=promb-1;#%

// ai = 0;#cykl (ai < 3)#{##ar = 0;#cykl (ar < 2)#{# ar = ar + 1;#disp(ar,' = ar ');#}## ai = ai + 1;#disp(ai,' = ai ');#}##
// $promb=60;#vara=111;#varb=222;#disp(promb,' = promb ');#cykl(promb<20)#{#promb=60;#}#promb=promb-1;#
// $promb=0;	#$promc=10;	## cykl (promb > 20)# {#  promb = 0;#  promc = promc + 1;# }##disp(' promc = ',promc,'     promb = ',promb);## cykl (promc > 40)# {#  promc = 10;#disp(' opakuj ');# }##   promb = promb + 1;#;



//######################################################## levy alt 35  zpet na Enter (asci kod 13) ###################################################



           while (idi <= Number(koni)) 
           {  //cykl
           uberec = sourec.substring(2,sourec.indexOf ("%"));//  strednik byl puvodne ;   nyni procenta Alt37 = %
           sourec = sourec.substring((sourec.indexOf ("%")+1),sourec.length);//  strednik byl puvodne ;   nyni procenta Alt37 = %
		    if  ( ( (uberec.indexOf ("nic"))>=0 )||( (uberec.indexOf ("undefined"))>=0 ) )   //vynechat zapis (and &&)
		      {
                    console.log(" nic undefined ");
              }
              else 
              {
	    	  var citiesRef = db.collection("users"); //pridani do firestore z edit pole s novym ID
                citiesRef.doc(String(idi)).set({  
                name: uberec });
              }
              idi = idi + 1;
           }  //cykl
//___________________________________________aktualizace gui_______________________________________________________________
msg.innerHTML = " zapsano do Firestore " ;
gui.remove(item1);
gui.remove(item2);
			   
     item1 = gui.add(params, "input_com_text").onFinishChange(function (ivalue) { });
     item2 = gui.add(params, "input_dataIO_text").onFinishChange(function (ovalue) { });
			   
//__________________________________________aktualizace gui________________________________________________________________
        	   }  //!!!
//----------------------------------------------pridani-----------------------------------------------
//----------------------------------------------mazani document---------------------------------------
		    if   ( (params.input_com_text.indexOf ("---"))>=0 )
		   {
		   params.input_com_text = params.input_com_text.substring(0,(params.input_com_text.length-1)); // odebrani ;  
           var poci = params.input_com_text.substring(0,(params.input_com_text.indexOf (",")));
           var koni = params.input_com_text.substring(params.input_com_text.indexOf (",")+1,params.input_com_text.indexOf ("--"));
           var idi = Number(poci);
           while (idi <= Number(koni)) 
           {  //cykl
		   db.collection("users").doc(String(idi)).delete().then(function() {  // odrizne minusy a vymaze dokument
                }).catch(function(error) {
                console.error("Error removing document: ", error);
                });
              idi = idi + 1;
           }  //cykl
//___________________________________________aktualizace gui_______________________________________________________________
msg.innerHTML = " smazano z Firestore " ;
gui.remove(item1);
gui.remove(item2);
			   
     item1 = gui.add(params, "input_com_text").onFinishChange(function (ivalue) { });
     item2 = gui.add(params, "input_dataIO_text").onFinishChange(function (ovalue) { });
			   
//__________________________________________aktualizace gui________________________________________________________________
			   
    	   }   //end "---"
//----------------------------------------------mazani document---------------------------------------			
	
//úúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúú
    if   ( (params.input_com_text.indexOf ("úúú"))>=0 ) 
     {   //beg bere pred úúú ctvrty znak od konce a ovlivnuje zetovy rozmer textu
     longu = params.input_com_text.substring(params.input_com_text.length-4,params.input_com_text.length-3);
     }   //end úúú
//úúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúúú


//WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW
		
//nechat    mesh.rotation.z -= Number(params.tField);



		    if   (ja < 367 )
		   { // k sobe
                   text1.position.x -= 0.02;
                   text2.position.x -= 0.04;

                   text1.scale.z += Number(longu)/10000;
                   text2.scale.z += Number(longu)/10000;
                   text3.scale.z += Number(longu)/10000;

//                   console.log("jj = ",jj);
                   }  //k sobe

                   if ((ja >= 367 ) && (ja < 700 ))
		   { // rotace
                   cube.rotation.x += 0.02;
                   cube.rotation.y += 0.02;
                   cube.rotation.z += 0.02;
                   }  // rotace


		    if   ((ja >= 700 ) && (ja < 1066 ))
		   { //  od sebe
                   text1.position.x += 0.02;
                   text2.position.x += 0.04;

                   text1.scale.z -= Number(longu)/10000;
                   text2.scale.z -= Number(longu)/10000;
                   text3.scale.z -= Number(longu)/10000;

                   }  // od sebe


		    if   (ja == 1067)
		   { //  opakuj
                   ja = 0; 
                   }  // opakuj



                   ja = ja + 1;

//	    text1.rotation.z += Number(params.input_com_text);
				renderer.setClearColor( 0x000000, 0 );
				renderer.setViewport( 0, 0, window.innerWidth, window.innerHeight );
				renderer.setClearColor( 0xcccccc, 1 );
				renderer.clearDepth(); // important!
		controls.update();
            requestAnimationFrame(render);
            renderer.render(scene, camera);
        }
//RRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRR
//nechat	    } );  //loader
//++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
    }

		    window.onload = init;
	
</script>
</body>
</html>

